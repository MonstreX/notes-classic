1. Масштабирование логики (Controller & State)
Разделение appController.ts: Сейчас это единственный контроллер. Чтобы избежать превращения его в «God Object», стоит выделить специализированные под-контроллеры: NoteController, FolderController и SearchController.

Глубокое обновление состояния: Текущие «shallow merges» (поверхностные слияния) в store.ts могут привести к ошибкам при обновлении вложенных структур (например, дерева тегов). Рекомендуется внедрить утилиту для глубокого клонирования или иммутабельных обновлений.

2. Оптимизация производительности (OCR & UI)
Перенос OCR в Backend: Сейчас Tesseract.js работает на стороне фронтенда. Это нагружает UI-поток. Перенос обработки изображений в Rust-часть (через системный Tesseract) позволит использовать многопоточность и полностью освободить интерфейс.

Виртуализация списков: При большом количестве заметок (тысячи записей) рендеринг всего списка в notesList.ts замедлит UI. Стоит внедрить «Virtual Scrolling», чтобы отрисовывать только видимые элементы.

3. Надежность и жизненный цикл (DOM)
Паттерн деструктуризации: В Vanilla JS проектах критически важна очистка памяти. Добавьте метод unmount() для каждого UI-модуля (sidebar.ts, editor.ts), который будет удалять слушатели событий (removeEventListener) и очищать таймеры при переключении контекста.

SQLite WAL Mode: Для предотвращения блокировок базы данных при одновременном поиске и автосохранении, включите режим Write-Ahead Logging (WAL) в db.rs.

4. Улучшение редактора и данных
Изоляция кастомных блоков: Логика callout-блоков и зашифрованных фрагментов завязана на DOM-состоянии Jodit. Вынесение этой логики в отдельные изолированные плагины Jodit упростит отладку и предотвратит поломку HTML-структуры при обновлении редактора.

Валидация при миграции: Расширьте migrate_to_v3, добавив проверку целостности данных (например, проверку наличия файлов для записей в note_files).
